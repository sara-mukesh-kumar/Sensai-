// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
  id            String  @id @default(uuid())
  clerkUserId   String  @unique //clerk user id 
  email         String  @unique 
  name          String?
  imageUrl      String?
  industry      String?  // cobined industry-subindustry (eg:"tech-software-development")
  industryInsight IndustryInsight? @relation(fields: [industry],references: [industry])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  //profile fields 
  bio           String?
  experience    Int?      //years of experience
  skills        String[]  //array of skills 
  
  assessments   Assessment[]
  resume        Resume?
  coverLetter   CoverLetter[]
}

model IndustryInsight{
  id        String  @id @default(cuid())
  industry  String  @unique  //the industry this data belongs to (eg "tech -software-development")

  //Users in this industry 
  users     User[]

  //salary data 
  salaryRanges Json[] //Array of {role: string, min:{Float, max:float, mediun:float, location:String?}}

  //industry trends 
  growthRate Float  //Industry growth growthRate
  demandLevel DemandLevel //"High", "medium", "Low"
  topSkills   String[] //Most in-demand skills

  //Market conditions
  marketOutlook MarketOutLook //"Positive" ,"Neutral", "Negative"
  keyTrends     String[] //Array of current industry trends

  //Learning suggestions
  recommendedSkills String[] //Skills recommended for the industry

  latUpdated    DateTime  @default(now())
  nextUpdate    DateTime  //schduled update time


@@index([industry])
}

model Assessment{

  id            String  @id @default(uuid())
  userId        String
  user          User    @relation(fields: [userId], references: [id])
  quizScore     Float   //over all quizScore
  questions     Json[]  //Array of {question, answer, userAnswer, IsCorrect}
  category      String  //Technical, behavioral, etc.
  improvementTip  String?  //AI generated improvement tip
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([userId])
}

model Resume{
  id         String   @id @default(cuid())
  userId     String   @unique
  user       User     @relation(fields: [userId], references:[id])
  content    String   @db.Text  //Markdown content
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
}

model CoverLetter{
  id         String   @id @default(cuid())
  userId     String  
  user       User     @relation(fields: [userId], references:[id])
  content    String    //Markdown content
  jobDescription String?
  companyName   String  //name of the company name
  jobTitle      String //position applying for 
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  @@index([userId])
}

enum DemandLevel{
  HIGH
  MEDIUM
  LOW
}

enum MarketOutLook{
  POSITIVE
  NEUTRAL
  NEGATIVE
}